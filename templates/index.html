<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Efficient Maintenance and Technical Assistance Chatbot</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/index_styles.css') }}">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css')}}">
</head>
<body>
    <div class="banner">
        THIS IS FOR REFERENCE ONLY. ALL INFORMATION SHOULD BE VERIFIED WITH CURRENT SOP'S
        <a href="#" id="commentPopupLink" style="color: #39FF14;">Leave a Comment</a>
    </div>

    </div>
    <span id="sidebarCollapse">&#9776; Menu</span>
    <div class="main-container">
        <!-- Left side content (Sidebar) -->
        <div class="sidebar">
            <h1>EMTAC</h1>
            <!-- Display the current user level -->
            <p>User Level: {{ session['user_level'] }}</p>
            <h2 style="color: Yellow;">Welcome {{ session['first_name'] }}! How can I assist you?</h2>
            <a href="/tsg_search_problems"style="color: #39FF14;">Search Troubleshooting</a>
            <a href="/upload_search_database" style="color: #39FF14;" class="upload-button">Search and Upload </a>
            <a href="/bill_of_materials"style="color: #39FF14;">Parts and BOMs</a>
            {% if session['user_level'] != 'STANDARD' %}
                <a href="/troubleshooting_guide" style="color: #39FF14;">Update Troubleshooting Guide</a>
            {% endif %}
            <button id="toggle-voice" class="toggle-button">Toggle Voice Recognition</button>
            <button id="toggle-text-to-speech" class="toggle-button">Toggle Text-to-Speech</button>
            <select id="voice-selection"></select>
            <a href="/logout" style="color:  #FF5F1F;"class="logout-button">Logout</a>
            <div class="model-display-section" {% if session['user_level'] != 'STANDARD' %} style="display: block;" {% else %} style="display: none;" {% endif %}>
                <p>Current AI Model: {{ current_ai_model }}</p>
                <p>Current Embedding Model: {{ current_embedding_model }}</p>
            </div>

        </div>

        <!-- Right side content -->
        <!-- Popup Modal Structure -->
<div id="commentPopup" style="display: none;">
    <form id="commentForm">
        <h2>Leave a Comment</h2>
        <!-- Instructions for filling out the form -->
        <p>Instructions: You can write your comment, paste an image, or upload a file.</p>

        <!-- Comment box where users can paste an image or type text -->
        <textarea name="comment" id="comment" placeholder="Write your comment here..." required></textarea><br>

        <!-- Hidden field to store base64 image data -->
        <input type="hidden" id="imageData" name="imageData">

        <!-- Display an indicator or preview if an image was pasted -->
        <div id="pastedImageFeedback" style="display: none; color: green;">
            Image snippet successfully added!
        </div>
        <img id="pastedImagePreview" src="" alt="Pasted Image Preview" style="display:none; max-width: 100px; margin-top: 10px;" />

        <!-- Option to upload a file -->
        <label for="fileUpload">Or upload an image:</label><br>
        <input type="file" id="fileUpload" name="screenshot" accept="image/*" /><br><br>

        <button type="submit">Send</button>
        <button type="button" id="closePopup">Close</button>
    </form>
</div>
        <div class="content">
            <div class="answer-section" id="answer-section">
                <p id="answer"></p>
            </div>

            <div class="thumbnails-section" id="thumbnails-section">
                <!-- Thumbnails will be displayed here -->
            </div>

            <div class="doc-links-section" id="doc-links-section">
                <!-- Hoverable links for relevant documents will be displayed here -->
            </div>

            <div class="user-input-container">
                <input type="text" id="user_id" placeholder="User ID" value="{{ employee_id }}" readonly style="display: none;">
                <select id="area" style="display: none;">
                    <!-- Options will be populated here -->
                </select>
                <div class="input-and-button">
                    <textarea id="user_input" placeholder="Your Question" rows="2" cols="50"></textarea>
                    <button id="submit-question">Ask</button>
                </div>
            </div>

            <div class="comment-box">
                <textarea id="comment" placeholder="Comment, suggestions or corrections"></textarea>
                <div class="rating-section">
                    <label for="rating">Rating:</label>
                    <select id="rating">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                        <option value="6">6</option>
                        <option value="7">7</option>
                        <option value="8">8</option>
                        <option value="9">9</option>
                        <option value="10">10</option>
                    </select>
                    <button id="submit_comment_rating">Submit</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Link to the external JavaScript file -->
    <script src="{{ url_for('static', filename='chatbot.js') }}"></script>
    <script src="{{ url_for('static', filename='chatbot_display_thumbnails.js') }}"></script>
    <script src="{{ url_for('static', filename='update_qanda_table.js') }}"></script>
    <script>
        document.getElementById("sidebarCollapse").onclick = function() {
            document.querySelector(".main-container").classList.toggle("collapsed");
        };

        document.getElementById("closeSidebar").onclick = function() {
            document.querySelector(".main-container").classList.toggle("collapsed");
        };

        // Add functionality to toggle buttons to highlight when active
        document.getElementById("toggle-voice").onclick = function() {
            this.classList.toggle("active");
        };

        document.getElementById("toggle-text-to-speech").onclick = function() {
            this.classList.toggle("active");
        };
    </script>
    <script src="{{ url_for('static', filename='js/comment_pop_up.js')}}"></script>
</body>
</html>
