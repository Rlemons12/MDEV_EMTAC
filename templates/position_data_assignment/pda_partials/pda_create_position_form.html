<!-- templates/position_data_assignment/pda_partials/pda_create_position_form.html -->

<div id="positionManagementContainer">
    <h3>Position Management</h3>

    <!-- Sub-Tab Navigation -->
    <div class="sub-tab-container">
        <ul class="sub-tab-list">
            <!-- 1) Create Position tab (default) -->
            <li class="sub-tab-item active" data-subtab="create-position">Create Position</li>
            <!-- 2) Search Positions tab -->
            <li class="sub-tab-item" data-subtab="search-positions">Search Positions</li>
            <!-- 3) Edit Position tab -->
            <li class="sub-tab-item" data-subtab="edit-positions">Edit Position</li>
        </ul>
    </div>

    <!-- Sub-Tab Content Sections -->

    <!-- 1) Create Position -->
    <div id="create-position" class="sub-tab-content active">
        <h4>Create a New Position</h4>

        <form id="positionForm" method="POST" action="{{ url_for('position_data_assignment_bp.search_position') }}" enctype="multipart/form-data">
            {{ form_create_position.hidden_tag() }}

            <!-- Area Field -->
            <div class="form-group">
                {{ form_create_position.area.label(class="form-label") }}
                {{ form_create_position.area(class="form-control") }}
            </div>

            <!-- Equipment Group Field -->
            <div class="form-group">
                {{ form_create_position.equipment_group.label(class="form-label") }}
                {{ form_create_position.equipment_group(class="form-control") }}
            </div>

            <!-- Model Field -->
            <div class="form-group">
                {{ form_create_position.model.label(class="form-label") }}
                {{ form_create_position.model(class="form-control") }}
            </div>

            <!-- Asset Number Field -->
            <div class="form-group">
                {{ form_create_position.asset_number.label(class="form-label") }}
                {{ form_create_position.asset_number(class="form-control") }}
            </div>

            <!-- Asset Number Input (Manual) -->
            <div class="form-group">
                {{ form_create_position.asset_number_input.label(class="form-label") }}
                {{ form_create_position.asset_number_input(class="form-control") }}
            </div>

            <!-- Location Field -->
            <div class="form-group">
                {{ form_create_position.location.label(class="form-label") }}
                {{ form_create_position.location(class="form-control") }}
            </div>

            <!-- Location Input (Manual) -->
            <div class="form-group">
                {{ form_create_position.location_input.label(class="form-label") }}
                {{ form_create_position.location_input(class="form-control") }}
            </div>

            <!-- Assembly Field -->
            <div class="form-group">
                {{ form_create_position.assembly.label(class="form-label") }}
                {{ form_create_position.assembly(class="form-control") }}
            </div>

            <!-- Assembly Input (Manual) -->
            <div class="form-group">
                {{ form_create_position.assembly_input.label(class="form-label") }}
                {{ form_create_position.assembly_input(class="form-control") }}
            </div>

            <!-- Subassembly Field -->
            <div class="form-group">
                {{ form_create_position.subassembly.label(class="form-label") }}
                {{ form_create_position.subassembly(class="form-control") }}
            </div>

            <!-- Subassembly Input (Manual) -->
            <div class="form-group">
                {{ form_create_position.subassembly_input.label(class="form-label") }}
                {{ form_create_position.subassembly_input(class="form-control") }}
            </div>

            <!-- Assembly View Field -->
            <div class="form-group">
                {{ form_create_position.assembly_view.label(class="form-label") }}
                {{ form_create_position.assembly_view(class="form-control") }}
            </div>

            <!-- Site Location Field -->
            <div class="form-group">
                {{ form_create_position.site_location.label(class="form-label") }}
                {{ form_create_position.site_location(class="form-control") }}
            </div>

            <!-- Position Name Field -->
            <div class="form-group">
                {{ form_create_position.position.label(class="form-label") }}
                {{ form_create_position.position(class="form-control", placeholder="Enter Position Name") }}
            </div>

            <!-- Part Numbers Field -->
            <div class="form-group">
                {{ form_create_position.part_numbers.label(class="form-label") }}
                {{ form_create_position.part_numbers(class="form-control", placeholder="Enter Part Numbers separated by commas") }}
            </div>

            <!-- Images Upload Field -->
            <div class="form-group">
                {{ form_create_position.images.label(class="form-label") }}
                {{ form_create_position.images(class="form-control-file", multiple=True) }}
            </div>

            <!-- Drawings Upload Field -->
            <div class="form-group">
                {{ form_create_position.drawings.label(class="form-label") }}
                {{ form_create_position.drawings(class="form-control-file", multiple=True) }}
            </div>

            <!-- Submit Button -->
            <button type="submit" name="submit_create_position" class="btn btn-primary">{{ form_create_position.submit.label.text }}</button>
        </form>
    </div>

    <!-- 2) Search Positions -->
    <div id="search-positions" class="sub-tab-content" style="display:none;">
        <h4>Search Positions</h4>

        <form id="positionSearchForm" method="POST" action="{{ url_for('position_data_assignment_bp.search_position') }}">
            {{ form_search_position.hidden_tag() }}

            <!-- Position ID Field -->
            <div class="form-group">
                {{ form_search_position.position_id.label(class="form-label") }}
                {{ form_search_position.position_id(class="form-control", placeholder="Enter Position ID") }}
            </div>

            <!-- Position Name Field -->
            <div class="form-group">
                {{ form_search_position.position_name.label(class="form-label") }}
                {{ form_search_position.position_name(class="form-control", placeholder="Enter Position Name") }}
            </div>

            <!-- Area Field -->
            <div class="form-group">
                {{ form_search_position.area.label(class="form-label") }}
                {{ form_search_position.area(class="form-control") }}
            </div>

            <!-- Equipment Group Field -->
            <div class="form-group">
                {{ form_search_position.equipment_group.label(class="form-label") }}
                {{ form_search_position.equipment_group(class="form-control") }}
            </div>

            <!-- Model Field -->
            <div class="form-group">
                {{ form_search_position.model.label(class="form-label") }}
                {{ form_search_position.model(class="form-control") }}
            </div>

            <!-- Start Date Field -->
            <div class="form-group">
                {{ form_search_position.start_date.label(class="form-label") }}
                {{ form_search_position.start_date(class="form-control", placeholder="YYYY-MM-DD") }}
            </div>

            <!-- End Date Field -->
            <div class="form-group">
                {{ form_search_position.end_date.label(class="form-label") }}
                {{ form_search_position.end_date(class="form-control", placeholder="YYYY-MM-DD") }}
            </div>

            <!-- Submit Button -->
            <button type="submit" name="search" class="btn btn-secondary">{{ form_search_position.search.label.text }}</button>
        </form>

        <!-- Results Section -->
        <div id="positionSearchResults" style="margin-top: 20px;">
            {% if results is not none %}
                {% if results %}
                    <table class="table table-bordered">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Area</th>
                                <th>Equipment Group</th>
                                <th>Model</th>
                                <th>Created At</th>
                                <!-- Add other headers as necessary -->
                            </tr>
                        </thead>
                        <tbody>
                            {% for position in results %}
                                <tr>
                                    <td>{{ position.id }}</td>
                                    <td>{{ position.name }}</td>
                                    <td>{{ position.area.name if position.area else 'N/A' }}</td>
                                    <td>{{ position.equipment_group.name if position.equipment_group else 'N/A' }}</td>
                                    <td>{{ position.model.name if position.model else 'N/A' }}</td>
                                    <td>{{ position.created_at.strftime('%Y-%m-%d') if position.created_at else 'N/A' }}</td>
                                    <!-- Add other data as necessary -->
                                </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                {% else %}
                    <p>No positions found matching the search criteria.</p>
                {% endif %}
            {% else %}
                <p>No search results yet...</p>
            {% endif %}
        </div>
    </div>



<!-- JavaScript for Sub-Tab Navigation and AJAX Form Handling -->
{% block extra_scripts %}
<script src="{{ url_for('static', filename='js/position_data_assignment/pda_partial_create_position_form.js') }}"></script>
{% endblock %}
