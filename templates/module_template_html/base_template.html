<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Efficient Maintenance and Technical Assistance Chatbot{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/module_template/base.css') }}">
    {% block extra_head %}{% endblock %}
</head>
<body
    style="
        background: #222;
        {% if chosen_image %}
            background: url('{{ url_for('static', filename='background images/module_template/' ~ chosen_image) }}') no-repeat center center fixed;
            background-size: cover;
        {% endif %}
    "
>
    <!-- Header Section -->
    <header>
        <div class="banner" role="banner">
            THIS IS FOR REFERENCE ONLY. ALL INFORMATION SHOULD BE VERIFIED WITH CURRENT SOP'S
            <a href="#" id="commentPopupLink" style="color: #39FF14;">Leave a Comment</a>
        </div>
    </header>

    <!-- Hamburger icon to collapse sidebar -->
    <button id="sidebarCollapse" class="hamburger" aria-label="Toggle sidebar" aria-expanded="false">
        &#9776;
    </button>

    <!-- Comment Popup Modal -->
    <div id="commentPopup" class="modal" aria-hidden="true" aria-labelledby="commentFormHeading">
        <form id="commentForm" class="modal-content" aria-modal="true">
            <h2 id="commentFormHeading">Leave a Comment</h2>
            <p>Instructions: You can write your comment, paste an image, or upload a file.</p>

            <textarea name="comment" id="comment" placeholder="Write your comment here..." required></textarea><br>
            <input type="hidden" id="imageData" name="imageData">

            <div id="pastedImageFeedback" style="display: none; color: green;">
                Image snippet successfully added!
            </div>
            <img id="pastedImagePreview" src="" alt="Pasted Image Preview" style="display:none; max-width: 100px; margin-top: 10px;" />

            <label for="fileUpload">Or upload an image:</label><br>
            <input type="file" id="fileUpload" name="screenshot" accept="image/*" /><br><br>

            <button type="submit">Send</button>
            <button type="button" id="closePopup">Close</button>
        </form>
    </div>

    <!-- Main Container -->
    <div class="main-container">
        <div class="sidebar">
            <h3><p>User Level: {{ session.get('user_level', 'Guest') }}</p></h3>
            <h1>Search</h1>
            <h2>Welcome {{ session.get('first_name', 'Guest') }}! How can I assist you?</h2>

            {% if session['user_level'] == 'ADMIN' or session['user_level'] == 'LEVEL_III' %}
                <hr>
            {% endif %}

            <!-- Preferences section for background images -->
            <form method="POST">
                <label for="background_choice" style="color:yellow;">Select Background:</label>
                <select name="background_choice" id="background_choice" style="width:90%; margin-bottom:10px;">
                    {% for img in images %}
                        <option value="{{ img }}" {% if chosen_image == img %}selected{% endif %}>{{ img }}</option>
                    {% endfor %}
                </select>
                <button type="submit" style="width:90%; background:#4CAF50; color:white;">Set Background</button>
            </form>
        </div>

        <main class="content">
            {% block content %}
            <h1>Welcome!</h1>
            <p>Select a background from the sidebar dropdown.</p>
            {% endblock %}
        </main>

        <div class="results-container" id="results-container" style="display: none;">
            <ul id="searchResults" style="color:white;"></ul>
            <div id="thumbnails-section"></div>
            <div id="drawingList"></div>
        </div>
    </div>

    <!-- Footer -->
    <footer>
        <!-- Site-wide footer content -->
    </footer>

    <!-- Include JavaScript -->
    <script src="{{ url_for('static', filename='js/module_template/base_sidebar.js') }}"></script>
    <script src="{{ url_for('static', filename='js/comment_pop_up.js') }}"></script>
    {% block extra_scripts %}{% endblock %}
</body>
</html>
