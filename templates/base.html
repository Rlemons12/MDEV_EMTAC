<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}Efficient Maintenance and Technical Assistance Chatbot{% endblock %}</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/base.css') }}">
    {% block extra_head %}{% endblock %}
</head>
<body>
    <!-- Top Banner -->
    <div class="banner">
        THIS IS FOR REFERENCE ONLY. ALL INFORMATION SHOULD BE VERIFIED WITH CURRENT SOP'S
        <a href="#" id="commentPopupLink" style="color: #39FF14;"Leave a Comment</a>
    </div>

    <!-- Sidebar and Main Container -->
    <!-- Popup Modal Structure -->
    <div id="commentPopup" style="display: none;">
        <form id="commentForm">
            <h2>Leave a Comment</h2>
            <!-- Instructions for filling out the form -->
            <p>Instructions: You can write your comment, paste an image, or upload a file.</p>

            <!-- Comment box where users can paste an image or type text -->
            <textarea name="comment" id="comment" placeholder="Write your comment here..." required></textarea><br>

            <!-- Hidden field to store base64 image data -->
            <input type="hidden" id="imageData" name="imageData">

            <!-- Display an indicator or preview if an image was pasted -->
            <div id="pastedImageFeedback" style="display: none; color: green;">
                Image snippet successfully added!
            </div>
            <img id="pastedImagePreview" src="" alt="Pasted Image Preview" style="display:none; max-width: 100px; margin-top: 10px;" />

            <!-- Option to upload a file -->
            <label for="fileUpload">Or upload an image:</label><br>
            <input type="file" id="fileUpload" name="screenshot" accept="image/*" /><br><br>

            <button type="submit">Send</button>
            <button type="button" id="closePopup">Close</button>
        </form>
    </div>
    <div class="main-container">
        <!-- Sidebar -->
        <div class="sidebar">
            <a href="javascript:void(0)" class="close-btn" id="closeSidebar">&times;</a>
            <h1>EMTAC</h1>
        <!-- Display the current user level -->
            <p>User Level: {{ session['user_level'] }}</p>
            <h2>Welcome {{ name }} how can I assist you?</h2>

            <!-- Adding all HREFs -->
            <a href="/" style="color: #39FF14;">Home</a>
            <a href="/tsg_search_problems" style="color: #39FF14;">Search Troubleshooting</a>
            <a href="/upload_image" style="color: #39FF14;" class="upload-button">Search and Upload</a>
            <a href="/bill_of_materials" style="color: #39FF14;">Parts and BOMs</a>
            <a href="/troubleshooting_guide" style="color: #39FF14;">Update Troubleshooting Guide</a>
            <a href="/logout" style="color: #FF5F1F;" class="logout-button">Logout</a>

            <!-- Optional hidden hrefs that were identified in previous files -->
            <a href="#search-documents" style="display: none;">Search Documents</a>
            <a href="#search-images" style="display: none;">Search Images</a>
            <a href="#compare-images" style="display: none;">Compare Images</a>

            <!-- Elements visible only to ADMIN and LEVEL_III users -->
            {% if session['user_level'] == 'ADMIN' or session['user_level'] == 'LEVEL_III' %}
            <button id="toggle-voice" class="toggle-button">Toggle Voice Recognition</button>
            <button id="toggle-text-to-speech" class="toggle-button">Toggle Text-to-Speech</button>
            <select id="voice-selection"></select>
            <div class="model-display-section">
                <p>Current AI Model: {{ current_ai_model }}</p>
                <p>Current Embedding Model: {{ current_embedding_model }}</p>
            </div>

            <!-- Restricted upload-related links -->
            <a href="#upload-image">Upload Image</a>
            <a href="#upload-document">Upload Document</a>
            <a href="#upload-powerpoint">Upload PowerPoint</a>
            <a href="#batch-upload">Batch Upload</a>
            {% endif %}
        </div>

        <!-- Main Content Area -->
        <div class="content">
            {% block content %}{% endblock %}
        </div>
    </div>

    <!-- Include JavaScript files -->
    <script src="{{ url_for('static', filename='js/base_sidebar.js') }}"></script>
    {% block extra_scripts %}{% endblock %}
<script src="{{ url_for('static', filename='js/comment_pop_up.js')}}"></script>
</body>
</html>
